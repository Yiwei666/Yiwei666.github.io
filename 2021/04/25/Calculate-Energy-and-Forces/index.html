<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Calculate Si_bulk8 Energy and Forces | IXY</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="庚子计算-AIMD与CP2K讲义3How to Calculate Energy and ForcesTable of ContentsIntroductionInput FilesRunning the CalculationObtaining the ResultsAdding Smearing  Introduction   In this tutorial, we are going to">
<meta property="og:type" content="article">
<meta property="og:title" content="Calculate Si_bulk8 Energy and Forces">
<meta property="og:url" content="https://example.com/2021/04/25/Calculate-Energy-and-Forces/index.html">
<meta property="og:site_name" content="IXY">
<meta property="og:description" content="庚子计算-AIMD与CP2K讲义3How to Calculate Energy and ForcesTable of ContentsIntroductionInput FilesRunning the CalculationObtaining the ResultsAdding Smearing  Introduction   In this tutorial, we are going to">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-04-25T13:54:34.000Z">
<meta property="article:modified_time" content="2021-05-13T01:59:59.473Z">
<meta property="article:author" content="YIWEI">
<meta property="article:tag" content="cp2k_keywords">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="IXY" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">IXY</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Calculate-Energy-and-Forces" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/04/25/Calculate-Energy-and-Forces/" class="article-date">
  <time class="dt-published" datetime="2021-04-25T13:54:34.000Z" itemprop="datePublished">2021-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CP2K/">CP2K</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Calculate Si_bulk8 Energy and Forces
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="庚子计算-AIMD与CP2K讲义3"><a href="#庚子计算-AIMD与CP2K讲义3" class="headerlink" title="庚子计算-AIMD与CP2K讲义3"></a><strong><a target="_blank" rel="noopener" href="https://maiimg.com/pdf/?e=agZSJn3BFh8Zwm">庚子计算-AIMD与CP2K讲义3</a></strong></h2><h2 id="How-to-Calculate-Energy-and-Forces"><a href="#How-to-Calculate-Energy-and-Forces" class="headerlink" title="How to Calculate Energy and Forces"></a>How to Calculate Energy and Forces</h2><h3 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h3><p><a href="#1">Introduction</a><br><a href="#2">Input Files</a><br><a href="#3">Running the Calculation</a><br><a href="#4">Obtaining the Results</a><br><a href="#5">Adding Smearing</a></p>
<ol>
<li><a name="1">Introduction</a></li>
</ol>
<ul>
<li>In this tutorial, we are going to show the reader how to perform a simple static self-consistent Kohn-Sham Density Functional Theory energy and force calculation on a system using QUICKSTEP.</li>
<li>We will use face centred cubic bulk Si, with 8 atoms in a cubic unit cell as an example. </li>
<li>The example files are contained in static_calculation.tgz. </li>
<li>The calculations were carried out with CP2K version 2.4.</li>
<li>The reader should note that the integration grid settings used in the example calculations have already chosen to be sufficient for the given accuracy. </li>
<li>A separate tutorial is available to show how to achieve this.</li>
</ul>
<ol start="2">
<li><a name="2">Input Files</a></li>
</ol>
<ul>
<li><p>We first look at the input files required for this calculation. The necessary input files are:</p>
<ul>
<li>Si_bulk8.inp: the main input file for the calculation, which defines the system and the job parameters</li>
<li>BASIS_SET: file containing parameters for the basis sets that can be used by CP2K for this calculation</li>
<li>GTH_POTENTIALS: file containing parameters for the pseudopotentials that can be used by CP2K for this calculation</li>
</ul>
</li>
<li><p>A list of basis set and pseudopotential files may be found in cp2k/data/ that comes with a cp2k source release. </p>
</li>
<li><p>These should cover most of the commonly used elements. </p>
</li>
<li><p>The user will, however, need to produce their own main input file for a given calculation.</p>
</li>
<li><p>Let us look at the main input: Si_bulk8.inp in detail. </p>
</li>
<li><p>The name of this file can be arbitrary, so is the file extension. </p>
</li>
<li><p>The input file is structured into ordered blocks and keywords, the order of which are unimportant. </p>
</li>
<li><p>Each input block is referred to as a “section” in this tutorial, and some sections are “subsections” of other sections. </p>
</li>
<li><p>Full definitions of the input file format and keywords is available via the ‘’CP2K’’ input reference manual.</p>
</li>
<li><p>The input file is shown below:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&amp;GLOBAL</span><br><span class="line">  PROJECT Si_bulk8</span><br><span class="line">  RUN_TYPE ENERGY_FORCE</span><br><span class="line">  PRINT_LEVEL LOW</span><br><span class="line">&amp;END GLOBAL</span><br><span class="line">&amp;FORCE_EVAL</span><br><span class="line">  METHOD Quickstep</span><br><span class="line">  &amp;SUBSYS</span><br><span class="line">    &amp;KIND Si</span><br><span class="line">      ELEMENT   Si</span><br><span class="line">      BASIS_SET DZVP-GTH-PADE</span><br><span class="line">      POTENTIAL GTH-PADE-q4</span><br><span class="line">    &amp;END KIND</span><br><span class="line">    &amp;CELL</span><br><span class="line">      A     5.430697500    0.000000000    0.000000000</span><br><span class="line">      B     0.000000000    5.430697500    0.000000000</span><br><span class="line">      C     0.000000000    0.000000000    5.430697500</span><br><span class="line">    &amp;END CELL</span><br><span class="line">    &amp;COORD</span><br><span class="line">      Si    0.000000000    0.000000000    0.000000000</span><br><span class="line">      Si    0.000000000    2.715348700    2.715348700</span><br><span class="line">      Si    2.715348700    2.715348700    0.000000000</span><br><span class="line">      Si    2.715348700    0.000000000    2.715348700</span><br><span class="line">      Si    4.073023100    1.357674400    4.073023100</span><br><span class="line">      Si    1.357674400    1.357674400    1.357674400</span><br><span class="line">      Si    1.357674400    4.073023100    4.073023100</span><br><span class="line">      Si    4.073023100    4.073023100    1.357674400</span><br><span class="line">    &amp;END COORD</span><br><span class="line">  &amp;END SUBSYS</span><br><span class="line">  &amp;DFT</span><br><span class="line">    BASIS_SET_FILE_NAME  BASIS_SET</span><br><span class="line">    POTENTIAL_FILE_NAME  GTH_POTENTIALS</span><br><span class="line">    &amp;QS</span><br><span class="line">      EPS_DEFAULT 1.0E-10</span><br><span class="line">    &amp;END QS</span><br><span class="line">    &amp;MGRID</span><br><span class="line">      NGRIDS 4</span><br><span class="line">      CUTOFF 300</span><br><span class="line">      REL_CUTOFF 60</span><br><span class="line">    &amp;END MGRID</span><br><span class="line">    &amp;XC</span><br><span class="line">      &amp;XC_FUNCTIONAL PADE</span><br><span class="line">      &amp;END XC_FUNCTIONAL</span><br><span class="line">    &amp;END XC</span><br><span class="line">    &amp;SCF</span><br><span class="line">      SCF_GUESS ATOMIC</span><br><span class="line">      EPS_SCF 1.0E-7</span><br><span class="line">      MAX_SCF 300</span><br><span class="line">      &amp;DIAGONALIZATION  ON</span><br><span class="line">        ALGORITHM STANDARD</span><br><span class="line">      &amp;END DIAGONALIZATION</span><br><span class="line">      &amp;MIXING  T</span><br><span class="line">        METHOD BROYDEN_MIXING</span><br><span class="line">        ALPHA 0.4</span><br><span class="line">        NBROYDEN 8</span><br><span class="line">      &amp;END MIXING</span><br><span class="line">    &amp;END SCF</span><br><span class="line">  &amp;END DFT</span><br><span class="line">  &amp;PRINT</span><br><span class="line">    &amp;FORCES ON</span><br><span class="line">    &amp;END FORCES</span><br><span class="line">  &amp;END PRINT</span><br><span class="line">&amp;END FORCE_EVAL</span><br></pre></td></tr></table></figure></li>
<li><p>The main sections in the input file are:</p>
</li>
<li><p>‘’GLOBAL’’: contains general options for the CP2K run, such as the name of the job, the type of run etc.</p>
</li>
<li><p>‘’FORCE_EVAL’’: contains all parameters associated with the evaluation of forces on atoms, this includes the initial atomic coordinates.</p>
</li>
<li><p>We look at each section in detail. The GLOBAL section in Si_bulk8.inp is presented below</p>
</li>
<li><p>We will be doing a static energy and force calculation, in this case, we must set ‘’RUN_TYPE’’ to ENERGY_FORCE. </p>
</li>
<li><p>Keyword ‘’PROJECT’’ is an alias for PROJECT_NAME, which sets the root-name of the calculation, in this case Si_bulk8. </p>
</li>
<li><p>Any output files automatically generated by CP2K will have the name prefixed by Si_bulk8. </p>
</li>
<li><p>‘’PRINT_LEVEL’’ controls the default verbosity of the main output of CP2K, in this example, it is set to “low”. </p>
</li>
<li><p>The verbosity of the output can be fine-tuned by overriding this setting in each individual subsection of the input.</p>
</li>
<li><p>We now explain the section FORCE_EVAL line-by-line.</p>
</li>
<li><p>The keyword ‘’METHOD’’ chooses the method for evaluating the forces on atoms to QUICKSTEP, i.e. </p>
</li>
<li><p>Density Functional Theory using the Gaussian and Planewaves (GPW) method.</p>
</li>
<li><p>The subsection ‘’SUBSYS’’ defines the simulation unit cell and the initial coordinates of atoms in the calculation.</p>
</li>
<li><p>The subsection ‘’KIND’’ gives definitions of elements in the calculation. </p>
</li>
<li><p>There must be one KIND subsection per element. </p>
</li>
<li><p>In this example, for Si, we have defined the basis set to be used: DZVP-GTH-PADE (double-ζ with polarisation basis optimised for Geodecker-Teter-Hutter PADE LDA pseudopotential); and the pseudopotential: GTH-PADE-q4 (Geodecker-Teter-Hutter PADE LDA pseudopotential with 4 valence electrons).</p>
</li>
<li><p>The basis set and pseudopotential names must correspond to an existing entry in the corresponding basis set and pseudopotential files defined by ‘’BASIS_SET_FILE_NAME’’ and ‘’POTENTIAL_FILE_NAME’’ keywords in ‘’DFT’’ subsection, in FORCE_EVAL section. </p>
</li>
<li><p>The chosen basis for Si corresponds to parameters:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Si DZVP-GTH-PADE</span><br><span class="line">  2</span><br><span class="line">  3  0  1  4  2  2</span><br><span class="line">        1.2032422345   0.3290350445   0.0000000000   0.0474539126   0.0000000000</span><br><span class="line">        0.4688409786  -0.2533118323   0.0000000000  -0.2594473573   0.0000000000</span><br><span class="line">        0.1679863234  -0.7870946277   0.0000000000  -0.5440929303   0.0000000000</span><br><span class="line">        0.0575619526  -0.1909898479   1.0000000000  -0.3624010364   1.0000000000</span><br><span class="line">  3  2  2  1  1</span><br><span class="line">        0.4500000000   1.0000000000</span><br></pre></td></tr></table></figure></li>
<li><p>in file BASIS_SET; and the chosen pseudopotential corresponds to parameters:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Si GTH-PADE-q4 GTH-LDA-q4</span><br><span class="line">    2    2</span><br><span class="line">     0.44000000    1    -7.33610297</span><br><span class="line">    2</span><br><span class="line">     0.42273813    2     5.90692831    -1.26189397</span><br><span class="line">                                        3.25819622</span><br><span class="line">     0.48427842    1     2.72701346</span><br></pre></td></tr></table></figure></li>
<li><p>in file GTH_POTENTIALS.</p>
</li>
<li><p>The subsection ‘’CELL’’ defines the simulation unit cell used in a calculation. </p>
</li>
<li><p>In this example, we define the unit cell as cubic, with lattice constant equal to 5.4306975 Angstroms. </p>
</li>
<li><p>“Angstrom” is the default unit for cell vectors.</p>
</li>
<li><p>‘’A’’, ‘’B’’ and ‘’C’’ are the first, second and third lattice (cell) vectors.</p>
</li>
<li><p>There are many ways to define the cell, see ‘’CP2K’’ input reference manual for more details.</p>
</li>
<li><p>The initial atomic coordinates are specified in the ‘’COORD’’ subsection. </p>
</li>
<li><p>The default input format for atomic coordinates in CP2K is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;ATOM_KIND&gt; X Y Z</span><br></pre></td></tr></table></figure></li>
<li><p>where X, Y and Z are Cartesian coordinates in Angstroms. </p>
</li>
<li><p>This can be changed by configuring keyword ‘’SCALED’’ to .TRUE., in the COORD subsection, which makes the coordinate input X Y Z to be fractional with respect to the lattice vectors. </p>
</li>
<li><p>One can also change the unit for the Cartesian coordinates by setting the keyword ‘’UNIT’’ with in the subsection. </p>
</li>
<li><p><ATOM_KIND> should be a label that corresponds to the definition of the elements in the ‘’KIND’’ subsections.</p>
</li>
<li><p>After the SUBSYS section in the input file Si_bulk8.inp follows the ‘’DFT’’ subsection, which controls all aspects of the self-consistent Kohn-Sham Density Functional Theory calculation. </p>
</li>
<li><p>This subsection is only relevant if and only if the METHOD keyword in FORCE_EVAL is set to QUICKSTEP.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASIS_SET_FILE_NAME  BASIS_SET</span><br><span class="line">POTENTIAL_FILE_NAME  GTH_POTENTIALS</span><br></pre></td></tr></table></figure></li>
<li><p>As already mentioned above, the keywords ‘’BASIS_SET_FILE_NAME’’ and ‘’POTENTIAL_FILE_NAME’’ set the files that contains basis set and pseudopotential parameters.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;QS</span><br><span class="line">  EPS_DEFAULT 1.0E-10</span><br><span class="line">&amp;END QS</span><br></pre></td></tr></table></figure></li>
<li><p>The ‘’QS’’ subsection contains general control parameters used by QUICKSTEP. </p>
</li>
<li><p>‘’EPS_DEFAULT’’ sets the default value for all tolerances used within QUICKSTEP. </p>
</li>
<li><p>The individual tolerances (EPS_*) can be set, and they will override the EPS_DEFAULT value.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;MGRID</span><br><span class="line">  NGRIDS 4</span><br><span class="line">  CUTOFF 300</span><br><span class="line">  REL_CUTOFF 60</span><br><span class="line">&amp;END MGRID</span><br></pre></td></tr></table></figure></li>
<li><p>The ‘’MGRID’’ subsection defines how the integration grid used in QUICKSTEP calculations should be setup. </p>
</li>
<li><p>QUICKSTEP uses a multi-grid method for representing Gaussian functions numerically on the grid. </p>
</li>
<li><p>Narrow and sharp Gaussians are mapped onto a finer grid than wider and smoother Gaussians. </p>
</li>
<li><p>In this case, we are telling the code to set up 4 levels of multi-grids,</p>
</li>
<li><p>with the planewave cutoff of the finest grid set to be 300 Ry, </p>
</li>
<li><p>and with the grid spacing underneath any Gaussian functions to be finer than the equivalent planewave cutoff of 60 Ry. </p>
</li>
<li><p>The users should read the tutorial “Converging the CUTOFF and REL_CUTOFF” for details on how these parameters affect the grid constructed, and how to define a sufficient grid for their calculation. </p>
</li>
<li><p>In this example, the grid defined has already been found to be sufficient for the energy and force calculation.</p>
</li>
<li><p>The ‘’XC’’ subsection follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;XC</span><br><span class="line">  &amp;XC_FUNCTIONAL PADE</span><br><span class="line">  &amp;END XC_FUNCTIONAL</span><br><span class="line">&amp;END XC</span><br></pre></td></tr></table></figure></li>
<li><p>This defines which exchange-correlation density functional we want to use. </p>
</li>
<li><p>In this we choose PADE LDA functional, which is consistent with the basis set and pseudopotential we have chosen.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&amp;SCF</span><br><span class="line">  SCF_GUESS ATOMIC</span><br><span class="line">  EPS_SCF 1.0E-7</span><br><span class="line">  MAX_SCF 300</span><br><span class="line">  &amp;DIAGONALIZATION</span><br><span class="line">    ALGORITHM STANDARD</span><br><span class="line">  &amp;END DIAGONALIZATION</span><br><span class="line">  &amp;MIXING</span><br><span class="line">    METHOD BROYDEN_MIXING</span><br><span class="line">    ALPHA 0.4</span><br><span class="line">    NBROYDEN 8</span><br><span class="line">  &amp;END MIXING</span><br><span class="line">&amp;END SCF</span><br></pre></td></tr></table></figure></li>
<li><p>The ‘’SCF’’ subsection defines all the settings related to methods used to find a self-consistent solution of the Kohn-Sham DFT formalism.</p>
</li>
<li><p>‘’SCF_GUESS’’ sets how the initial trial electron density function ρ(→r) is to be generated. </p>
</li>
<li><p>In this example (ATOMIC), the initial density is to be generated using overlapping of atomic charge densities. </p>
</li>
<li><p>A good starting point for the electron density in the self-consistency loop is important in obtaining a convergent result quickly. </p>
</li>
<li><p>‘’EPS_SCF’’ sets the tolerance of the charge density residual. </p>
</li>
<li><p>This overrides the EPS_DEFAULT value set in QS subsection. </p>
</li>
<li><p>‘’MAX_SCF’’ sets the maximum number of self-consistency loops QUICKSTEP is allowed to perform for each ground-state energy calculation.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;DIAGONALIZATION  ON</span><br><span class="line">  ALGORITHM STANDARD</span><br><span class="line">&amp;END DIAGONALIZATION</span><br></pre></td></tr></table></figure></li>
<li><p>The ‘’DIAGONALIZATION ‘’ subsection tells the code to use the traditional diagonalisation method for finding the ground state Kohn-Sham energy and electron density. </p>
</li>
<li><p>The subsection heading also takes an argument, and in this case is set to “ON”, which equivalent to “.TRUE.” or “T”, and indicates that the diagonalisation method is turned on. </p>
</li>
<li><p>One can also omit the value of the subsection heading, which defaults to “.TRUE.”. </p>
</li>
<li><p>The alternative to diagonalisation is to use the Orbital Transform (OT) method, in which case, the user should either delete the DIAGONALIZATION block or change “ON” to “OFF” (or “.FALSE.”), and add the ‘’OT’’ subsection instead. </p>
</li>
<li><p>The ‘’ALGORITHM’’ keyword sets the algorithm to use for diagonalisation of the Kohn-Sham Hamiltonian. </p>
</li>
<li><p>“STANDARD” means the standard LAPACK/SCALAPACK subroutines are to be used for diagonalisation.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;MIXING  T</span><br><span class="line">  METHOD BROYDEN_MIXING</span><br><span class="line">  ALPHA 0.4</span><br><span class="line">  NBROYDEN 8</span><br><span class="line">&amp;END MIXING</span><br></pre></td></tr></table></figure></li>
<li><p>The ‘’MIXING’’ subsection contains all the parameters associated with charge mixing in a self-consistency calculation. </p>
</li>
<li><p>The subsection also admits a value, which can be either .TRUE. (T) or .FALSE. (F), which switches charge mixing on or off. </p>
</li>
<li><p>The default is .TRUE.. Note that this subsection only applies to the traditional diagonalisation method. </p>
</li>
<li><p>The OT method uses a different approach for charge mixing, and is explained in other tutorials. </p>
</li>
<li><p>The keyword ‘’ALPHA’’ sets the mixing parameter; in this example 0.4 of the output density will be mixed with 0.6 of the input density to form the new input density in the next SCF iteration. </p>
</li>
<li><p>The keyword ‘’METHOD’’ sets the mixing method; in this case, we will use Broyden mixing. </p>
</li>
<li><p>The keyword ‘’NBROYDEN’’ is an alias to the parameter NBUFFER, and it sets the number of histories to be used in the Broyden mixing algorithm.</p>
</li>
<li><p>The final ‘’PRINT’’ subsection in FORCE_EVAL section:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;PRINT</span><br><span class="line">  &amp;FORCES ON</span><br><span class="line">  &amp;END FORCES</span><br><span class="line">&amp;END PRINT</span><br></pre></td></tr></table></figure></li>
<li><p>tells CP2K, in this case, to print out atomic forces in the main output of the calculation.</p>
</li>
</ul>
<ol start="3">
<li><a name="3">Running the Calculation</a></li>
</ol>
<ul>
<li>To run the calculation, the reader needs to have a working CP2K package compiled, and with the path to its binaries in the system PATH. </li>
<li>The files Si_bulk8.inp, BASIS_SET and GTH_POTENTIAL should be in the same working directory. </li>
<li>In this example, we will use the MPI version of CP2K. Type command:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mpirun -n 2 cp2k.popt -o Si_bulk8.out Si_bulk8.inp &amp;</span><br></pre></td></tr></table></figure></li>
<li>in the working directory to run CP2K in parallel with 2 MPI processes in the background. </li>
<li>The -o option redirects the CP2K output to file Si_bulk8.out. </li>
<li>Note that the -o option appends output of successive runs to Si_bulk8.out, so if the reader wants to start completely from afresh, they must delete Si_bulk8.out before running a new calculation.</li>
</ul>
<ol start="4">
<li><a name="4">Obtaining the Results</a></li>
</ol>
<ul>
<li>After the job has finished, we should obtain the following files:<ul>
<li>Si_bulk8.out</li>
<li>Si_bulk8-RESTART.wfn</li>
<li>Si_bulk8-RESTART.wfn.bak-1</li>
</ul>
</li>
<li>The file Si_bulk8.out contains the main output of the job. </li>
<li>Si_bulk8-RESTART.wfn is the final Kohn-Sham wavefunctions from the calculation. </li>
<li>Si_bulk8-RESTART.wfn.bak-<n> records the Kohn-Sham wavefunctions obtained from the <n>-th previous SCF step; in this case, Si_bulk8-RESTART.wfn.bak-1 contains the wavefunctions obtained from the last SCF step. </li>
<li>Should the reader want to start a new calculation from the previous calculated wavefunctions, they need to change the SCF_GUESS keyword in SCF subsection of FORCE_EVAL section to RESTART:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SCF_GUESS RESTART</span><br></pre></td></tr></table></figure>
provided that the new calculation shares the same PROJECT_NAME as the one that generated the wavefunctions. </li>
<li>Otherwise, we would need to rename the restart wavefunction files to correspond to the project name of the new calculation.</li>
<li>We now look at the main CP2K output in more detail.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Number of electrons:                                                         32</span><br><span class="line">Number of occupied orbitals:                                                 16</span><br><span class="line">Number of molecular orbitals:                                                16</span><br><span class="line"></span><br><span class="line">Number of orbital functions:                                                104</span><br><span class="line">Number of independent orbital functions:                                    104</span><br><span class="line"></span><br><span class="line">Extrapolation method: initial_guess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">SCF WAVEFUNCTION OPTIMIZATION</span><br><span class="line"></span><br><span class="line"> Step     Update method      Time    Convergence         Total energy    Change</span><br><span class="line"> ------------------------------------------------------------------------------</span><br><span class="line">    1 NoMix&#x2F;Diag. 0.40E+00    0.6     0.75558724       -32.2320848878 -3.22E+01</span><br><span class="line">    2 Broy.&#x2F;Diag. 0.40E+00    1.1     0.05667976       -31.1418135481  1.09E+00</span><br><span class="line">    3 Broy.&#x2F;Diag. 0.40E+00    1.1     0.09691469       -31.1974003416 -5.56E-02</span><br><span class="line">    4 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00245608       -31.3378474040 -1.40E-01</span><br><span class="line">    5 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00235460       -31.3009654398  3.69E-02</span><br><span class="line">    6 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00007565       -31.2972158934  3.75E-03</span><br><span class="line">    7 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00009004       -31.2977293749 -5.13E-04</span><br><span class="line">    8 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00000186       -31.2978454163 -1.16E-04</span><br><span class="line">    9 Broy.&#x2F;Diag. 0.40E+00    1.1     0.00000252       -31.2978835492 -3.81E-05</span><br><span class="line">   10 Broy.&#x2F;Diag. 0.40E+00    1.1     5.6405E-09       -31.2978852054 -1.66E-06</span><br><span class="line"></span><br><span class="line"> *** SCF run converged in    10 steps ***</span><br></pre></td></tr></table></figure></li>
<li>The above shows a typical output from a self-consistent Kohn-Sham ground state calculation. </li>
<li>It states that we are using diagonalisation method with Broyden charge mixing, and it took 10 Broyden mixing steps (each containing a diagonalisation process to obtain the wavefunctions) to reach the required tolerance for self-consistency.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> Electronic density on regular grids:        -31.9999999889        0.0000000111</span><br><span class="line"> Core density on regular grids:               31.9999999939       -0.0000000061</span><br><span class="line"> Total charge density on r-space grids:        0.0000000051</span><br><span class="line"> Total charge density g-space grids:           0.0000000051</span><br><span class="line"></span><br><span class="line"> Overlap energy of the core charge distribution:               0.00000000005320</span><br><span class="line"> Self energy of the core charge distribution:                -82.06393942512820</span><br><span class="line"> Core Hamiltonian energy:                                     18.06858429706010</span><br><span class="line"> Hartree energy:                                              42.41172824581682</span><br><span class="line"> Exchange-correlation energy:                                 -9.71425832315952</span><br><span class="line"></span><br><span class="line"> Total energy:                                               -31.29788520535761</span><br><span class="line"></span><br><span class="line">ENERGY| Total FORCE_EVAL ( QS ) energy (a.u.):              -31.297885372811002</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ATOMIC FORCES in [a.u.]</span><br><span class="line"></span><br><span class="line"># Atom   Kind   Element          X              Y              Z</span><br><span class="line">     1      1      Si          0.00000000     0.00000000     0.00000000</span><br><span class="line">     2      1      Si          0.00000000     0.00000001     0.00000001</span><br><span class="line">     3      1      Si          0.00000001     0.00000001     0.00000000</span><br><span class="line">     4      1      Si          0.00000001     0.00000000     0.00000001</span><br><span class="line">     5      1      Si         -0.00000001    -0.00000001    -0.00000001</span><br><span class="line">     6      1      Si         -0.00000001    -0.00000001    -0.00000001</span><br><span class="line">     7      1      Si         -0.00000001    -0.00000001    -0.00000001</span><br><span class="line">     8      1      Si         -0.00000001    -0.00000001    -0.00000001</span><br><span class="line">SUM OF ATOMIC FORCES          -0.00000000    -0.00000000    -0.00000000     0.00000000</span><br></pre></td></tr></table></figure></li>
<li>The above shows the results on final energies and forces. </li>
<li>One should always check if the total number of electrons calculated from the final electron density, in this case 31.9999999939, is correct.</li>
<li>The results show that the force on the atoms are almost zero. </li>
<li>This means the system is more or less relaxed, and its geometry is close to its optimal at ground state.</li>
</ul>
<ol start="5">
<li><a name="5">Adding Smearing</a></li>
</ol>
<ul>
<li>In the example so far, we have not used any smearing on electron occupation. </li>
<li>This is fine for system with a large band gap. </li>
<li>However, for metals or systems with a small gap, this may cause the calculation to be unstable, and the self-consistency loop may never converge, due to the discontinuity in the electron occupation function.</li>
<li>To add smearing, we need to add the subsection ‘’SMEAR’’ inside subsection SCF:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&amp;SMEAR ON</span><br><span class="line">  METHOD FERMI_DIRAC</span><br><span class="line">  ELECTRONIC_TEMPERATURE [K] 300</span><br><span class="line">&amp;END SMEAR</span><br></pre></td></tr></table></figure></li>
<li>This tells QUICKSTEP to use a smearing function for the electron occupation. </li>
<li>In this example, we use the Fermi-Dirac smearing function, with the electron temperature being set to 300 K. </li>
<li>Note that, in CP2K, one can explicitly define the unit of a given input value by using a unit enclosed in square bracket, such as “[K]”, before the value.</li>
<li>This is not all, since smearing may lead to occupation of molecular orbitals in the conduction band, we must tell CP2K to include extra, empty, molecular orbitals into the calculation, which otherwise would be omitted (for reducing computational cost). </li>
<li>To do this, we need to add the keyword ‘’ADDED_MOS’’ in the SCF subsection:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ADDED_MOS 10</span><br></pre></td></tr></table></figure></li>
<li>In this example, we have asked CP2K to not to omit 10 of the lowest empty molecular orbitals in the calculation. </li>
<li>It should be noted that given a chosen basis set, there is a maximum number of molecular orbitals, i.e. the number of eigenvectors of the Hamiltonian, one can generate. </li>
<li>In theory, the maximum should be the rank of the Hamiltonian generated in the calculation.</li>
<li>In the output of the calculation using smearing, we first notice that:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Number of electrons:                                                         32</span><br><span class="line">Number of occupied orbitals:                                                 16</span><br><span class="line">Number of molecular orbitals:                                                26</span><br><span class="line"></span><br><span class="line">Number of orbital functions:                                                104</span><br><span class="line">Number of independent orbital functions:                                    104</span><br></pre></td></tr></table></figure></li>
<li>unlike in the previous case with no smearing, now 26 molecular orbitals have been used during the calculation. </li>
<li>There are a total of 104 basis functions (“atom centred orbitals” spanned by Cartesian Gaussians) used in the calculation for the given basis set, so 26 is well within the limit of the calculation.<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> Electronic density on regular grids:        -31.9999999889        0.0000000111</span><br><span class="line"> Core density on regular grids:               31.9999999939       -0.0000000061</span><br><span class="line"> Total charge density on r-space grids:        0.0000000051</span><br><span class="line"> Total charge density g-space grids:           0.0000000051</span><br><span class="line"></span><br><span class="line"> Overlap energy of the core charge distribution:               0.00000000005320</span><br><span class="line"> Self energy of the core charge distribution:                -82.06393942512820</span><br><span class="line"> Core Hamiltonian energy:                                     18.06842027191411</span><br><span class="line"> Hartree energy:                                              42.41184371469986</span><br><span class="line"> Exchange-correlation energy:                                 -9.71419454555998</span><br><span class="line"> Electronic entropic energy:                                  -0.00001687947145</span><br><span class="line"> Fermi energy:                                                 0.20867150262130</span><br><span class="line"></span><br><span class="line"> Total energy:                                               -31.29788686349247</span><br><span class="line"></span><br><span class="line">ENERGY| Total FORCE_EVAL ( QS ) energy (a.u.):              -31.297887031736590</span><br></pre></td></tr></table></figure></li>
<li>In the final energy section of the output, we notice that there is an extra entropy (TS) term:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Electronic entropic energy:                                  -0.00001687947145</span><br></pre></td></tr></table></figure></li>
<li>This should be small for the calculation to be a reliable approximation to the zero electron temperature result. </li>
<li>The final free energy is the sum of the total DFT energy and the entropic energy. The total DFT energy is given by:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Total energy:                                               -31.29788686349247</span><br></pre></td></tr></table></figure>
and the final free energy extrapolated for TS→0 is given by:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENERGY| Total FORCE_EVAL ( QS ) energy (a.u.):              -31.297887031736590</span><br></pre></td></tr></table></figure></li>
<li>This is the energy to be quoted as the final result.</li>
</ul>
<hr>
<h2 id="cp2k计算Si的单点能"><a href="#cp2k计算Si的单点能" class="headerlink" title="cp2k计算Si的单点能"></a><a target="_blank" rel="noopener" href="https://www.cp2k.org/howto:static_calculation">cp2k计算Si的单点能</a></h2><h2 id="keywords-list"><a href="#keywords-list" class="headerlink" title="keywords list"></a><a target="_blank" rel="noopener" href="https://manual.cp2k.org/#gsc.tab=0">keywords list</a></h2><h3 id="cp2k-input-file"><a href="#cp2k-input-file" class="headerlink" title="cp2k input file"></a><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT.html">cp2k input file</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;GLOBAL</span><br><span class="line">  PROJECT Si_bulk8</span><br><span class="line">  RUN_TYPE ENERGY_FORCE</span><br><span class="line">  PRINT_LEVEL LOW</span><br><span class="line">&amp;END GLOBAL</span><br></pre></td></tr></table></figure>
<p><strong><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/GLOBAL.html">GLOBAL</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/GLOBAL.html#PROJECT_NAME">PROJECT</a> Si_bulk8<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/GLOBAL.html#RUN_TYPE">RUN_TYPE</a> ENERGY_FORCE<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/GLOBAL.html#PRINT_LEVEL">PRINT_LEVEL</a> LOW</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&amp;FORCE_EVAL</span><br><span class="line">  METHOD Quickstep</span><br><span class="line">  &amp;SUBSYS</span><br><span class="line">    &amp;KIND Si</span><br><span class="line">      ELEMENT   Si</span><br><span class="line">      BASIS_SET DZVP-GTH-PADE</span><br><span class="line">      POTENTIAL GTH-PADE-q4</span><br><span class="line">    &amp;END KIND</span><br><span class="line">    &amp;CELL</span><br><span class="line">      A     5.430697500    0.000000000    0.000000000</span><br><span class="line">      B     0.000000000    5.430697500    0.000000000</span><br><span class="line">      C     0.000000000    0.000000000    5.430697500</span><br><span class="line">    &amp;END CELL</span><br><span class="line">    &amp;COORD</span><br><span class="line">      Si    0.000000000    0.000000000    0.000000000</span><br><span class="line">      Si    0.000000000    2.715348700    2.715348700</span><br><span class="line">      Si    2.715348700    2.715348700    0.000000000</span><br><span class="line">      Si    2.715348700    0.000000000    2.715348700</span><br><span class="line">      Si    4.073023100    1.357674400    4.073023100</span><br><span class="line">      Si    1.357674400    1.357674400    1.357674400</span><br><span class="line">      Si    1.357674400    4.073023100    4.073023100</span><br><span class="line">      Si    4.073023100    4.073023100    1.357674400</span><br><span class="line">    &amp;END COORD</span><br><span class="line">  &amp;END SUBSYS</span><br></pre></td></tr></table></figure>
<p><strong><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL.html">FORCE_EVAL</a> #计算能量和受力的部分<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL.html#METHOD">METHOD</a> #计算受力的方法，包括FIST,QMMM,QS,NNP,EIP等<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL.html#STRESS_TENSOR">STRESS_TENSOR</a> #是否计算晶胞的应力<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS.html">SUBSYS</a> #控制原子坐标、晶胞参数、元素/原子的基组赝势等信息<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/CELL.html">CELL</a> #定义晶胞边长，也可以从其他文件里读取晶胞的信息，比如CIF、XSC文件，通过<a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/CELL.html#CELL_FILE_FORMAT">CELL_FILE_FORMAT</a>和<a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/CELL.html#CELL_FILE_NAME">CELL_FILE_NAME</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/COORD.html">COORD</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/KIND.html">KIND</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/KIND.html#ELEMENT">ELEMENT</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/KIND.html#BASIS_SET">BASIS_SET</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/SUBSYS/KIND.html#POTENTIAL">POTENTIAL</a></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&amp;DFT</span><br><span class="line">  BASIS_SET_FILE_NAME  BASIS_SET</span><br><span class="line">  POTENTIAL_FILE_NAME  GTH_POTENTIALS</span><br><span class="line">  &amp;QS</span><br><span class="line">    EPS_DEFAULT 1.0E-10</span><br><span class="line">  &amp;END QS</span><br><span class="line">  &amp;MGRID</span><br><span class="line">    NGRIDS 4</span><br><span class="line">    CUTOFF 300</span><br><span class="line">    REL_CUTOFF 60</span><br><span class="line">  &amp;END MGRID</span><br><span class="line">  &amp;XC</span><br><span class="line">    &amp;XC_FUNCTIONAL PADE</span><br><span class="line">    &amp;END XC_FUNCTIONAL</span><br><span class="line">  &amp;END XC</span><br></pre></td></tr></table></figure>
<p><strong><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT.html">DFT</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT.html#BASIS_SET_FILE_NAME">BASIS_SET_FILE_NAME</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT.html#POTENTIAL_FILE_NAME">POTENTIAL_FILE_NAME</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/QS.html">QS</a> #控制DFT等计算的一些参数精度<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/QS.html#EPS_DEFAULT">EPS_DEFAULT</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/QS.html#EXTRAPOLATION">EXTRAPOLATION</a> #控制波函数外推的一些方法，建议用ASPC<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/QS.html#EXTRAPOLATION_ORDER">EXTRAPOLATION_ORDER</a> #一般用默认值3<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/MGRID.html">MGRID</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/MGRID.html#NGRIDS">NGRIDS</a> #NGRIDS控制的就是几套网格，每套网格的截断能不一样，一般用默认值NGRIDS 4<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/MGRID.html#list_CUTOFF">CUTOFF</a> #CUTOFF是整体网格精度的最高值，单位是Ry(Rydberg)，设置取决于体系中元素的种类，默认280 Ry<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/MGRID.html#REL_CUTOFF">REL_CUTOFF</a> #REL_CUTOFF 参数控制有多少网格点落到最精细的级别，默认为40 Ry，一般设置到50 或60 Ry<br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/XC.html">XC</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/XC/XC_FUNCTIONAL.html">XC_FUNCTIONAL</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/XC/XC_FUNCTIONAL/PADE.html">PADE</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/XC/XC_FUNCTIONAL/PBE.html">PBE</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/XC/VDW_POTENTIAL.html">VDW_POTENTIAL</a></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">    &amp;SCF</span><br><span class="line">      SCF_GUESS ATOMIC</span><br><span class="line">      EPS_SCF 1.0E-7</span><br><span class="line">      MAX_SCF 300</span><br><span class="line">      &amp;DIAGONALIZATION  ON</span><br><span class="line">        ALGORITHM STANDARD</span><br><span class="line">      &amp;END DIAGONALIZATION</span><br><span class="line">      &amp;MIXING  T</span><br><span class="line">        METHOD BROYDEN_MIXING</span><br><span class="line">        ALPHA 0.4</span><br><span class="line">        NBROYDEN 8</span><br><span class="line">      &amp;END MIXING</span><br><span class="line">    &amp;END SCF</span><br><span class="line">  &amp;END DFT</span><br><span class="line">  &amp;PRINT</span><br><span class="line">    &amp;FORCES ON</span><br><span class="line">    &amp;END FORCES</span><br><span class="line">  &amp;END PRINT</span><br><span class="line">&amp;END FORCE_EVAL</span><br></pre></td></tr></table></figure>
<p><strong><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF.html">SCF</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF.html#SCF_GUESS">SCF_GUESS</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF.html#EPS_SCF">EPS_SCF</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF.html#MAX_SCF">MAX_SCF</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF/DIAGONALIZATION.html">DIAGONALIZATION</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF/DIAGONALIZATION.html#ALGORITHM">ALGORITHM</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF/MIXING.html">MIXING</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF/MIXING.html#METHOD">METHOD</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/SCF/MIXING.html#list_ALPHA">ALPHA</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT.html">PRINT</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/PRINT/FORCES.html">FORCES</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/DOS.html">DOS</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/PDOS.html">PDOS</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/MULLIKEN.html">MULLIKEN</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/ELF_CUBE.html">ELF_CUBE</a><br><a target="_blank" rel="noopener" href="https://manual.cp2k.org/cp2k-8_1-branch/CP2K_INPUT/FORCE_EVAL/DFT/PRINT/MO_CUBES.html">MO_CUBES</a></strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://example.com/2021/04/25/Calculate-Energy-and-Forces/" data-id="ckoqy52w8001os0tjfndo554t" data-title="Calculate Si_bulk8 Energy and Forces" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cp2k-keywords/" rel="tag">cp2k_keywords</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/04/27/important-paper-online/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Lammps, DFT and Gaussian Paper Online
        
      </div>
    </a>
  
  
    <a href="/2021/04/23/cp2k-summer-school/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Collection of CP2K Exercises</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AIMD-Paper-Review/">AIMD Paper Review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CP2K/">CP2K</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gaussian/">Gaussian</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Gaussian-Review/">Gaussian Review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MD/">MD</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-learning-Review/">Machine learning Review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Note/">Note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PYTHON/">PYTHON</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/">Paper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper-Review/">Paper Review</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VASP/">VASP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/basic-concept/">basic concept</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/email/">email</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%9B%BE%E7%89%87/">图片</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AF%BC%E8%88%AA/">导航</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B4%E7%90%86/">整理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%B5%E5%AD%90%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95-%E4%B8%89/">电子结构方法(三)</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%AB%99/">网站</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%AE%BA%E6%96%87/">论文</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/32-H2O/" rel="tag">32 H2O</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CUTOFF-and-REL-CUTOFF/" rel="tag">CUTOFF and REL_CUTOFF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Liquid-Si-Standard-MD/" rel="tag">Liquid Si - Standard MD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Main-Page/" rel="tag">Main Page</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note/" rel="tag">Note</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note2/" rel="tag">Note2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note3/" rel="tag">Note3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note4/" rel="tag">Note4</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Note5/" rel="tag">Note5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paper-and-Citing/" rel="tag">Paper and Citing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Paper-and-Writing/" rel="tag">Paper and Writing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cp2k-example/" rel="tag">cp2k_example</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cp2k-keywords/" rel="tag">cp2k_keywords</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cp2k%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/" rel="tag">cp2k思维导图</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/picture/" rel="tag">picture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/potential-parameters/" rel="tag">potential parameters</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python-grammer-and-exercise/" rel="tag">python grammer and exercise</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reply/" rel="tag">reply</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/website/" rel="tag">website</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D%E8%BE%A8%E6%9E%90/" rel="tag">专业名词辨析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E8%80%85%E6%96%B9%E5%90%91/" rel="tag">学者方向</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%9E%E9%AA%8C%E5%92%8C%E5%85%B6%E4%BB%96%E6%A8%A1%E6%8B%9F%E7%B1%BB/" rel="tag">实验和其他模拟类</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%80%9D%E6%83%B3%E5%AE%B6%E7%9A%84%E5%85%AC%E7%A4%BE/" rel="tag">思想家的公社</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/32-H2O/" style="font-size: 10px;">32 H2O</a> <a href="/tags/CUTOFF-and-REL-CUTOFF/" style="font-size: 10px;">CUTOFF and REL_CUTOFF</a> <a href="/tags/Liquid-Si-Standard-MD/" style="font-size: 10px;">Liquid Si - Standard MD</a> <a href="/tags/Main-Page/" style="font-size: 10px;">Main Page</a> <a href="/tags/Note/" style="font-size: 10px;">Note</a> <a href="/tags/Note2/" style="font-size: 10px;">Note2</a> <a href="/tags/Note3/" style="font-size: 10px;">Note3</a> <a href="/tags/Note4/" style="font-size: 10px;">Note4</a> <a href="/tags/Note5/" style="font-size: 10px;">Note5</a> <a href="/tags/Paper-and-Citing/" style="font-size: 10px;">Paper and Citing</a> <a href="/tags/Paper-and-Writing/" style="font-size: 10px;">Paper and Writing</a> <a href="/tags/cp2k-example/" style="font-size: 10px;">cp2k_example</a> <a href="/tags/cp2k-keywords/" style="font-size: 10px;">cp2k_keywords</a> <a href="/tags/cp2k%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE/" style="font-size: 10px;">cp2k思维导图</a> <a href="/tags/picture/" style="font-size: 10px;">picture</a> <a href="/tags/potential-parameters/" style="font-size: 10px;">potential parameters</a> <a href="/tags/python-grammer-and-exercise/" style="font-size: 10px;">python grammer and exercise</a> <a href="/tags/reply/" style="font-size: 10px;">reply</a> <a href="/tags/website/" style="font-size: 10px;">website</a> <a href="/tags/%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D%E8%BE%A8%E6%9E%90/" style="font-size: 10px;">专业名词辨析</a> <a href="/tags/%E5%AD%A6%E8%80%85%E6%96%B9%E5%90%91/" style="font-size: 10px;">学者方向</a> <a href="/tags/%E5%AE%9E%E9%AA%8C%E5%92%8C%E5%85%B6%E4%BB%96%E6%A8%A1%E6%8B%9F%E7%B1%BB/" style="font-size: 10px;">实验和其他模拟类</a> <a href="/tags/%E6%80%9D%E6%83%B3%E5%AE%B6%E7%9A%84%E5%85%AC%E7%A4%BE/" style="font-size: 10px;">思想家的公社</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">June 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/16/Matlab-and-Python/">Matlab and Python</a>
          </li>
        
          <li>
            <a href="/2021/06/18/Experiment-and-Other-Modeling/">Experiment and Other Modeling</a>
          </li>
        
          <li>
            <a href="/2021/06/17/%E5%AD%A6%E8%80%85%E4%B8%8E%E6%96%B9%E5%90%91/">学者与方向</a>
          </li>
        
          <li>
            <a href="/2021/06/16/%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D/">专业名词</a>
          </li>
        
          <li>
            <a href="/2021/06/09/%E7%94%B5%E5%AD%90%E7%BB%93%E6%9E%84%E6%96%B9%E6%B3%95/">电子结构方法</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 YIWEI<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>